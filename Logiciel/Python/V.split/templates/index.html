<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">                             
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <title>Serrebrooke</title>
</head>
<body>
    <div class="container mt-4">
        <button id="nightModeButton" onclick="toggleNightMode()" class="btn btn-dark mb-4">Dark Mode</button>
        <h1 id="title" class="text-center mb-4">Serrebrooke</h1>
        <ul class="nav nav-tabs" id="myTab" role="tablist">       
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#Dashboard" type="button" role="tab" aria-controls="Dashboard" aria-selected="true">Tableau de bord</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="control-tab" data-bs-toggle="tab" data-bs-target="#Control" type="button" role="tab" aria-controls="Control" aria-selected="false">Contr√¥le</button>
            </li>  
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="programming-tab" data-bs-toggle="tab" data-bs-target="#Programming" type="button" role="tab" aria-controls="Programming" aria-selected="false">Programmation</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="download-tab" data-bs-toggle="tab" data-bs-target="#Download" type="button" role="tab" aria-controls="Download" aria-selected="false">T√©l√©charger</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="settings-tab" data-bs-toggle="tab" data-bs-target="#Settings" type="button" role="tab" aria-controls="Settings" aria-selected="false">Param√®tres</button>
            </li>                      
        </ul> 
         
        <div class="tab-content" id="myTabContent">                          
            <div class="tab-pane fade" id="Control" role="tabpanel" aria-labelledby="control-tab">
                <div class="control-panel">

                    <!-- Chauffage -->
                    <div class="control-button" onclick="toggleDeviceState('10.42.0.23', 'chauffageState', 'action/chauffage')">
                        <span class="control-icon">üî•</span>
                        Chauffage: <span id="chauffageState" class="control-status"></span>                
                    </div>

                    <!-- Lumi√®re  -->
                    <div class="control-button" onclick="toggleDeviceState('10.42.0.130', 'lumiere1State', 'action/lumiere1')">
                        <span class="control-icon">üí°</span>
                        Lumi√®re : <span id="lumiere1State" class="control-status"></span>
                    </div>
             
                    <!-- Ventilation -->
                    <div class="control-button" onclick="toggleDeviceState('10.42.0.88', 'ventilationState', 'action/ventilation')">
                        <span class="control-icon">üåÄ</span>
                        Ventilation: <span id="ventilationState" class="control-status"></span>
                    </div>
                    <!-- D√©shumidificateur -->
                    <div class="control-button" onclick="toggleDeviceState('10.42.0.85', 'deshumidificateurState', 'action/deshumidificateur')">
                        <span class="control-icon">üíß</span>
                        Humidificateur: <span id="deshumidificateurState" class="control-status"></span>                
                    </div>              
                </div>                      
            </div>
            <div class="tab-pane fade" id="Settings" role="tabpanel" aria-labelledby="settings-tab">
                
            </div>
            <div class="tab-pane fade" id="Download" role="tabpanel" aria-labelledby="download-tab">
                <h2>Download Data: 30 jours</h1>
                <div class="download-buttons">
                    <button onclick="window.location.href = '/download/json'" class="btn btn-primary m-2 ">Download JSON</button>
                    <button onclick="window.location.href = '/download/xml'" class="btn btn-primary m-2">Download XML</button>
                    <button onclick="window.location.href = '/download/csv'" class="btn btn-primary m-2">Download CSV</button>
                </div>
            </div>                    
            <div class="tab-pane fade" id="Programming" role="tabpanel" aria-labelledby="programming-tab">
                <div class="container">
                    <!-- Temp√©rature Section -->                  
                    <div class="section-frame"> 
                        <button class="btn btn-success" onclick="saveSettings()">Sauvegarde</button>                
                        <h2>Chauffage<span id="chauffageIcon" class="state-icon">üî¥</span></h2>
                        <label for="tempDeadband">Bande morte de temp√©rature:</label>
                        <input type="number" id="tempDeadband" class="input-value form-control" placeholder="Temp√©rature en ¬∞C">                                
                        <h4>Temp√©rature (Moyenne: <span id="averageTemperature">Loading...</span>¬∞C)</h4>    
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="activerTemp" onchange="toggleTemperatureSection(this.checked);">
                            <label class="form-check-label" for="activerTemp">Activer</label>
                            <div class="tooltip">?
                                <span class="tooltiptext">Activer ou d√©sactiver le point de consigne hors horaire.</span>
                            </div>      
                        </div>
                        <label for="temperatureValue">Point de consigne Chauffage:</label>
                        <input type="number" id="temperatureValue" class="input-value form-control" placeholder="Entrez la temp√©rature en Celsius" step="1.0" disabled>
                                 
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="activerSecondTemp" onchange="toggleSecondTemperatureSection(this.checked);" >
                            <label class="form-check-label" for="activerSecondTemp">Activer Chauffage</label>
                            <div class="tooltip">?
                                <span class="tooltiptext">Activer ou d√©sactiver le point de consigne pour la plage horaire choisi.</span>
                            </div>       
                        </div>
                        <label for="secondTemperatureValue">Point de consigne Chauffage:</label>
                        <input type="number" id="secondTemperatureValue" class="input-value form-control" placeholder="Entrez une autre temp√©rature en Celsius" step="1.0" disabled>
                        <label for="chauffageStartTime">Heure de d√©marrage Chauffage:</label>
                        <input type="time" id="heatingStartTime" class="form-control time-input" disabled>
                        <label for="chauffageEndTime">Heure de fin Chauffage:</label>
                        <input type="time" id="heatingEndTime" class="form-control time-input" disabled>
                    </div>
                    
                    <!-- Ventilation Section -->
                    <div class="section-frame">
                        <h2>Ventilation<span id="ventilationIcon" class="state-icon">üî¥</span></h2>
                        <label for="ventDeadband">Bande morte de ventilation:</label>
                        <input type="number" id="ventDeadband" class="input-value form-control" placeholder="Humidit√© en %">          
                        <h4>Humidit√© (Derni√®re: <span id="latestHumidity">Loading...</span>%)</h4>             
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="activerHumidity" onchange="toggleHumidityControl(this.checked);">
                            <label class="form-check-label" for="activerHumidity">Activer</label>
                            <span class="tooltip">?
                                <span class="tooltiptext">Activer ou d√©sactiver le point de consigne hors horaire.</span>
                            </span>
                        </div>
                        <label for="humidityValue">Point de consigne Humidit√©:</label>          
                        <input type="number" id="humidityValue" class="input-value form-control" placeholder="Humidit√© (%)" min="0" max="100" disabled>                      
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="activerVent" onchange="toggleVentilationControl(this.checked);">
                            <label class="form-check-label" for="activerVent">Activer Contr√¥les</label>
                            <span class="tooltip">?
                                <span class="tooltiptext">Activer ou d√©sactiver le point de consigne pour la plage horaire choisi.</span>
                            </span>                    
                        </div>
                        <label for="humidityValue2">Point de consigne Humidit√©:</label>
                        <input type="number" id="humidityValue2" class="input-value form-control" placeholder="Humidit√© (%)" min="0" max="100" disabled >          
                        <label for="ventilationStartTime">Heure de d√©marrage Ventilation:</label>
                        <input type="time" id="ventilationStartTime" class="form-control time-input" disabled>
                        <label for="ventilationEndTime">Heure de fin Ventilation:</label>
                        <input type="time" id="ventilationEndTime" class="form-control time-input" disabled>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="activateTimer" onchange="toggleTimerControl(this.checked);">
                            <label class="form-check-label" for="activateTimer">Activer Mode Timer</label>
                        </div>
                        <label for="timerOn">Temps ON (secondes):</label>
                        <input type="number" id="timerOn" class="input-value form-control" placeholder="Temps ON en secondes" disabled>
                        
                        <label for="timerOff">Temps OFF (minutes):</label>
                        <input type="number" id="timerOff" class="input-value form-control" placeholder="Temps OFF en minutes" disabled>
                                            
                    </div>                 
                    <!-- Humidificateur Section -->
                    <div class="section-frame">
                        <h2>Humidificateur<span id="humidificateurIcon" class="state-icon">üî¥</span></h2>
                        <label for="humDeadband">Bande morte d'humidit√©:</label>
                        <input type="number" id="humDeadband" class="input-value form-control" placeholder="Humidit√© en %">          
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="activateHumidificateur" onchange="toggleHumidificateurSection(this.checked);">
                            <label class="form-check-label" for="activateHumidificateur">Activer</label>
                        </div>
                        <label for="humidificateurValue">Point de consigne Humidit√©:</label>
                        <input type="number" id="humidificateurValue" class="input-value form-control" placeholder="Humidit√© (%)" min="0" max="100" disabled>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="activateHumidificateurSchedule" onchange="toggleHumidificateurSchedule(this.checked);">
                            <label class="form-check-label" for="activateHumidificateurSchedule">Activer Horaires</label>
                        </div>
                        <label for="secondHumidificateurValue">Point de consigne secondaire:</label>
                        <input type="number" id="secondHumidificateurValue" class="input-value form-control" placeholder="Humidit√© (%)" min="0" max="100" disabled>
                        <label for="humidificateurStartTime">Heure de d√©marrage:</label>
                        <input type="time" id="humidificateurStartTime" class="form-control time-input" disabled>
                        <label for="humidificateurEndTime">Heure de fin:</label>
                        <input type="time" id="humidificateurEndTime" class="form-control time-input" disabled>
                    </div>
                    <!-- Lumi√®re Section -->
                    <div class="section-frame">                         
                        <h2>Lumi√®re<span id="lumiereIcon" class="state-icon">üî¥</span></h2>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="activerLight" onchange="toggleLightSection(this.checked);">
                            <label class="form-check-label" for="activerLight">Activer</label>
                            <span class="tooltip">?
                                <span class="tooltiptext">Activer ou d√©sactiver le mode horaire pour l'√©clairage avec la plage horaire sp√©cifi√©e.</span>
                            </span>
                        </div>
                        <label for="lightStartTime">Heure de d√©marrage Lumi√®re:</label>         
                        <input type="time" id="lightStartTime" class="form-control time-input" disabled>
                        <label for="lightEndTime">Heure de fin Lumi√®re:</label>
                        <input type="time" id="lightEndTime" class="form-control time-input" disabled>                                   
                    </div>
                </div>                                                                                                                                                                   
            </div>                      
            <div class="tab-pane fade show active" id="Dashboard" role="tabpanel" aria-labelledby="dashboard-tab">
                                 
                <div class="row">
                    <div class="col-md-6 mb-4">            
                        <select class="form-control" style="width: 150px;  margin-top: 10px;" onchange="updateGraph(this.value, 'chart1')">
                            <option value="600">Derni√®re heure</option>
                            <option value="1300">Derni√®re 3 heures</option>
                            <option value="3600">Derni√®re 6 heures</option>
                            <option value="16000">Dernier jour</option>
                            <option value="44000">Dernier 3 jours</option>
                            <option value="120800">Derni√®re semaine</option>
                        </select> 
                        <div class="embed-responsive embed-responsive-16by9">
                            <iframe id="chart1" class="embed-responsive-item w-100" style="height: 300px;" src="https://thingspeak.com/channels/1296899/charts/1?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=600&title=Temp%C3%A9rature+D1&type=line&xaxis=Time&yaxis=Temp%C3%A9rature" allowfullscreen></iframe>
                        </div>   
                    </div> 
                    <div class="col-md-6 embed-responsive embed-responsive-16by9 mb-4">
                        <iframe class="embed-responsive-item w-100" style="height: 300px ; margin-top: 50px;" src="https://thingspeak.com/channels/1296899/widgets/421466" allowfullscreen></iframe>
                    </div>            
                </div>
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <select class="form-control" style="width: 150px;  margin-top: 10px;" onchange="updateGraph(this.value, 'chart2',2)">
                            <option value="600">Derni√®re heure</option>
                            <option value="1300">Derni√®re 3 heures</option>
                            <option value="3600">Derni√®re 6 heures</option>
                            <option value="16000">Dernier jour</option>
                            <option value="44000">Dernier 3 jours</option>
                            <option value="120800">Derni√®re semaine</option>
                        </select>          
                        <div class="embed-responsive embed-responsive-16by9">
                            <iframe id="chart2" class="embed-responsive-item w-100" style="height: 300px;" src="https://thingspeak.com/channels/1296899/charts/2?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=600&title=Temp%C3%A9rature+D2&type=line&xaxis=Time&yaxis=Temp%C3%A9rature"> allowfullscreen></iframe>
                        </div>
                    </div>             
                    <div class="col-md-6 embed-responsive embed-responsive-16by9 mb-4">
                        <iframe class="embed-responsive-item w-100" style="height: 300px; margin-top: 50px;" src="https://thingspeak.com/channels/1296899/widgets/421467" allowfullscreen></iframe>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-4">              
                        <select class="form-control" style="width: 150px;  margin-top: 10px;" onchange="updateGraph(this.value, 'chart3',3)">
                            <option value="600">Derni√®re heure</option>
                            <option value="1300">Derni√®re 3 heures</option>
                            <option value="3600">Derni√®re 6 heures</option>
                            <option value="16000">Dernier jour</option>
                            <option value="44000">Dernier 3 jours</option>
                            <option value="120800">Derni√®re semaine</option>
                        </select>          
                        <div class="embed-responsive embed-responsive-16by9">
                            <iframe id="chart3" class="embed-responsive-item w-100" style="height: 300px;" src="https://thingspeak.com/channels/1296899/charts/3?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=600&title=Temp%C3%A9rature+D3&type=line&xaxis=Time&yaxis=Temp%C3%A9rature" allowfullscreen></iframe>
                        </div>
                    </div>
                    <div class="col-md-6 embed-responsive embed-responsive-16by9 mb-4">
                        <iframe class="embed-responsive-item w-100" style="height: 300px; margin-top: 50px;" src="https://thingspeak.com/channels/1296899/widgets/421468" allowfullscreen></iframe>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <select class="form-control" style="width: 150px;  margin-top: 10px;" onchange="updateGraph(this.value, 'chart4',4)">
                            <option value="600">Derni√®re heure</option>
                            <option value="1300">Derni√®re 3 heures</option>
                            <option value="3600">Derni√®re 6 heures</option>
                            <option value="16000">Dernier jour</option>
                            <option value="44000">Dernier 3 jours</option>
                            <option value="120800">Derni√®re semaine</option>
                        </select>            
                        <div class="embed-responsive embed-responsive-16by9">
                            <iframe id="chart4" class="embed-responsive-item w-100" style="height: 300px;" src="https://thingspeak.com/channels/1296899/charts/4?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=600&title=Temp%C3%A9rature+D4&type=line&xaxis=Time&yaxis=Temp%C3%A9rature" allowfullscreen></iframe>
                        </div>
                    </div>
                    <div class="col-md-6 embed-responsive embed-responsive-16by9 mb-4">
                        <iframe class="embed-responsive-item w-100" style="height: 300px; margin-top: 50px;" src="https://thingspeak.com/channels/1296899/widgets/421469" allowfullscreen></iframe>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <select class="form-control" style="width: 150px;  margin-top: 10px;"  onchange="updateEnvironmentalGraph(this.value, 'chart6', 6)">
                            <option value="600">Derni√®re heure</option>
                            <option value="1300">Derni√®re 3 heures</option>
                            <option value="3600">Derni√®re 6 heures</option>
                            <option value="16000">Dernier jour</option>
                            <option value="44000">Dernier 3 jours</option>
                            <option value="120800">Derni√®re semaine</option>
                        </select> 
                        <div class="embed-responsive embed-responsive-16by9">
                            <iframe id="chart6" class="embed-responsive-item w-100" style="height: 300px;" src="https://thingspeak.com/channels/1296899/charts/6?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=200&title=CO%C2%B2&type=line&xaxis=Time&yaxis=PPM" allowfullscreen></iframe>
                        </div>
                    </div>
                    <div class="col-md-6 embed-responsive embed-responsive-16by9 mb-4">
                        <iframe class="embed-responsive-item w-100" style="height: 300px; margin-top: 50px;" src="https://thingspeak.com/channels/1296899/widgets/421472" allowfullscreen></iframe>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <select class="form-control" style="width: 150px;  margin-top: 10px;" onchange="updateEnvironmentalGraph(this.value, 'chart7', 7)">
                            <option value="600">Derni√®re heure</option>
                            <option value="1300">Derni√®re 3 heures</option>
                            <option value="3600">Derni√®re 6 heures</option>
                            <option value="16000">Dernier jour</option>
                            <option value="44000">Dernier 3 jours</option>
                            <option value="120800">Derni√®re semaine</option>
                        </select>
                        <div class="embed-responsive embed-responsive-16by9">
                            <iframe id="chart7" class="embed-responsive-item w-100" style="height: 300px;" src="https://thingspeak.com/channels/1296899/charts/7?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=600&title=Humidit%C3%A9&type=line&xaxis=Time&yaxis=%25" allowfullscreen></iframe>
                        </div>
                    </div>              
                    <div class="col-md-6 embed-responsive embed-responsive-16by9 mb-4">
                        <iframe class="embed-responsive-item w-100" style="height: 300px; margin-top: 50px;" src="https://thingspeak.com/channels/1296899/widgets/421471" allowfullscreen></iframe>
                    </div>
                </div>
            </div>                                                  
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='scripts.js') }}"></script>
</body>
</html>
